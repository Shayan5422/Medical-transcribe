<div class="min-h-screen bg-base-200">
  
  
  <div class="flex">
    <!-- Barre latérale -->
    <aside class="w-full md:w-1/4 bg-base-100 border-r border-base-300 p-4 overflow-auto">
      <h2 class="text-xl font-semibold mb-4 text-base-content">
        Historique des Transcriptions
      </h2>
      <ul class="space-y-4">
        <li *ngFor="let record of history">
          <button 
            class="w-full text-left p-4 rounded-lg bg-base-200 hover:bg-base-300 transition-colors duration-200 flex flex-col space-y-1"
            (click)="selectUpload(record.upload_id)">
            <div class="flex items-center space-x-2 text-sm font-medium text-base-content">
             
            </div>
            <div class="text-sm text-base-content break-all">
              <span class="font-bold">Fichier : </span>{{ record.filename }}
            </div>
            <div class="text-sm text-gray-500">
              <span class="font-bold">Heure : </span>{{ record.upload_time | date:'short' }}
            </div>
          </button>
        </li>
      </ul>
    </aside>
    

    <!-- Contenu principal -->
    <main class="flex-1 p-8 space-y-8">
      <!-- Section upload de fichier -->
      <div class="card bg-base-100 shadow-md p-6">
        <h3 class="card-title mb-4 text-lg font-semibold">Télécharger un Fichier Audio</h3>
        <div class="flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4">
          <input type="file" (change)="onFileSelected($event)" accept="audio/*" class="file-input file-input-bordered w-full md:w-auto">
          <button class="btn btn-success" (click)="uploadSelectedFile()" [disabled]="!selectedFile || isTranscribing">
            Télécharger et Transcrire
          </button>
        </div>
      </div>

      <!-- Section enregistrement -->
      <div class="card bg-base-100 shadow-md p-6">
        <h3 class="card-title mb-4 text-lg font-semibold">Enregistrer de l'Audio</h3>
        <div class="flex space-x-4">
          <button class="btn btn-primary" (click)="startRecording()" [disabled]="isRecording">
            Démarrer l'Enregistrement
          </button>
          <button class="btn btn-error" (click)="stopRecording()" [disabled]="!isRecording">
            Arrêter l'Enregistrement
          </button>
        </div>
      </div>

      <!-- Message de chargement -->
      <div *ngIf="isTranscribing" class="alert alert-info shadow-lg">
        <div class="flex items-center space-x-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" 
                  stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 
                  0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>Veuillez patienter, la transcription est en cours...</span>
        </div>
      </div>

      <!-- Affichage de la transcription récente -->
      <div class="card bg-base-100 shadow-md p-6" *ngIf="transcription">
        <h3 class="card-title mb-4 text-lg font-semibold">Transcription</h3>
        <p class="mb-4 text-sm text-gray-700 whitespace-pre-wrap">{{ transcription }}</p>
        <div class="space-x-4">
          <button class="btn btn-outline" (click)="downloadTranscription()">
            Télécharger la Transcription
          </button>
          <button class="btn btn-primary" (click)="downloadAudioFile(selectedUploadId!)">
            Télécharger l'Audio
          </button>
          <button class="btn btn-secondary" (click)="downloadTranscriptionAsPDF(selectedUploadId!)">
            Télécharger en PDF
          </button>
        </div>
      </div>

      <!-- Transcription sélectionnée depuis l'historique -->
      <div class="card bg-base-100 shadow-md p-6" *ngIf="selectedTranscription">
        <h3 class="card-title mb-4 text-lg font-semibold">Transcription Sélectionnée</h3>
        <p class="mb-4 text-sm text-gray-700 whitespace-pre-wrap">{{ selectedTranscription }}</p>
        <div class="space-x-4">
          <button class="btn btn-outline" (click)="downloadTranscriptionFile(selectedUploadId!)">
            Télécharger la Transcription
          </button>
          <button class="btn btn-primary" (click)="downloadAudioFile(selectedUploadId!)">
            Télécharger l'Audio
          </button>
          <button class="btn btn-secondary" (click)="downloadTranscriptionAsPDF(selectedUploadId!)">
            Télécharger en PDF
          </button>
        </div>
      </div>
    </main>
  </div>
</div>
